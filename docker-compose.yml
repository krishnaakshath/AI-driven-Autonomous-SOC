version: '3.8'

services:
  # Main Web Application
  web:
    build: .
    container_name: soc_dashboard
    ports:
      - "8501:8501"
    environment:
      - GROQ_API_KEY=${GROQ_API_KEY}
      - SMTP_SERVER=${SMTP_SERVER}
      - SMTP_PORT=${SMTP_PORT}
      - SENDER_EMAIL=${SENDER_EMAIL}
      - SENDER_PASSWORD=${SENDER_PASSWORD}
    restart: always

  # Background Threat Monitor (The "Watcher")
  monitor:
    build: .
    container_name: soc_monitor
    entrypoint: ["python", "services/background_monitor.py"]
    environment:
      - SMTP_SERVER=${SMTP_SERVER}
      - SMTP_PORT=${SMTP_PORT}
      - SENDER_EMAIL=${SENDER_EMAIL}
      - SENDER_PASSWORD=${SENDER_PASSWORD}
    restart: always
